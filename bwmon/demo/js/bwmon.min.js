window.VERSION="2.3.1";
/*
	bwmon v2.3.1
	(C) 2010 - 2015 VREM Software Development
	https://github.com/VREMSoftwareDevelopment/bwmon
	License: Apache-2.0
*/
!function(){"use strict";angular.module("BWMonApp",["ngRoute","ui.bootstrap","angularUtils.directives.dirPagination","n3-line-chart","BWMonApp.Filters","BWMonApp.Navigation","BWMonApp.UsageByUser","BWMonApp.UsageByMonth","BWMonApp.UsageByYear","BWMonApp.SelectYear","BWMonApp.SelectMonth","BWMonApp.ChartType","BWMonApp.ChartService","BWMonApp.DataService"]).config(["$routeProvider",function(t){t.otherwise({redirectTo:"/UsageByUser"})}]).controller("rootController",["$interval","$scope",function(t,e){var r=this,a=function(){r.clock=new Date},n=t(a,1e3);a(),r.currentDate=r.clock,r.version=window.VERSION||"SNAPSHOT",e.$on("$destroy",function(e){t.cancel(n)})}]),angular.module("BWMonApp").run(["$templateCache",function(t){t.put("index.tpl.html",'<!doctype html>\r\n<html lang="en" ng-app="BWMonApp" ng-controller="rootController as rootCtrl">\r\n<head>\r\n	<meta charset="utf-8">\r\n	<meta name="viewport" content="width=device-width,initial-scale=1">\r\n	<title>Bandwidth Monitor Usage</title>\r\n<!-- @ifdef PRODUCTION -->\r\n	<link rel="stylesheet" href="css/bootstrap.min.css">\r\n	<link rel="stylesheet" href="css/bwmon.min.css">\r\n<!-- @endif -->\r\n<!-- @ifdef DEVELOPMENT -->\r\n	<link rel="stylesheet" href="../bower_components/bootstrap/dist/css/bootstrap.min.css">\r\n	<link rel="stylesheet" href="css/app.css">\r\n<!-- @endif -->\r\n</head>\r\n<body class="container">\r\n	<h2>\r\n		<span class="pull-left">Bandwidth Monitor Usage</span>\r\n		<small class="pull-right">{{rootCtrl.clock  | date: \'medium\'}}</small>\r\n		<span class="clearfix"></span>\r\n	</h2>\r\n	<navigation></navigation>\r\n	<div class="ng-view-min-height">\r\n		<div ng-view></div>\r\n	</div>\r\n	<h5>\r\n		<b>All usage information is in gigabytes</b>\r\n	</h5>\r\n	<h5>\r\n		<span class="pull-left">This page was generated on {{::rootCtrl.currentDate | date: \'medium\'}}</span>\r\n		<span class="pull-right">Version {{::rootCtrl.version}}</span>\r\n		<span class="clearfix"></span>\r\n	</h5>\r\n	<script src="bwmonUsage.js"></script>\r\n<!-- @ifdef PRODUCTION -->\r\n	<script src="js/libs.js"></script>\r\n	<script src="js/bwmon.min.js"></script>\r\n<!-- @endif -->\r\n<!-- @ifdef DEVELOPMENT -->\r\n	<script src="../bower_components/angular/angular.min.js"></script>\r\n	<script src="../bower_components/angular-route/angular-route.min.js"></script>\r\n	<script src="../bower_components/angular-bootstrap/ui-bootstrap-tpls.min.js"></script>\r\n	<script src="../bower_components/angularUtils-pagination/dirPagination.js"></script>\r\n	<script src="../bower_components/underscore/underscore-min.js"></script>\r\n	<script src="../bower_components/momentjs/min/moment.min.js"></script>\r\n	<script src="../bower_components/d3/d3.min.js"></script>\r\n	<script src="../bower_components/n3-line-chart/build/line-chart.min.js"></script>\r\n	<script src="app.js"></script>\r\n	<script src="navigation/navigation.js"></script>\r\n	<script src="services/dataService.js"></script>\r\n	<script src="services/chartService.js"></script>\r\n	<script src="usagebyuser/usageByUser.js"></script>\r\n	<script src="usagebymonth/usageByMonth.js"></script>\r\n	<script src="usagebyyear/usageByYear.js"></script>\r\n	<script src="common/filters.js"></script>\r\n	<script src="common/selectYear.js"></script>\r\n	<script src="common/selectMonth.js"></script>\r\n	<script src="common/chartType.js"></script>\r\n<!-- @endif -->\r\n</body>\r\n</html>'),t.put("usagebymonth/usageByMonth.tpl.html",'<uib-tabset justified="true">\r\n	<uib-tab id="Data" heading="Data">\r\n		<month-form></month-form>\r\n		<month-table></month-table>\r\n	</uib-tab>\r\n	<uib-tab id="Chart" heading="Chart">\r\n		<month-chart-form></month-chart-form>\r\n		<month-chart></month-chart>\r\n	</uib-tab>\r\n</uib-tabset>'),t.put("usagebyuser/usageByUser.tpl.html",'<uib-tabset justified="true">\r\n	<uib-tab id="Data" heading="Data">\r\n		<user-form></user-form>\r\n		<user-table></user-table>\r\n	</uib-tab>\r\n	<uib-tab id="Chart" heading="Chart">\r\n		<user-chart-form></user-chart-form>\r\n		<user-chart></user-chart>\r\n	</uib-tab>\r\n</uib-tabset>'),t.put("usagebyyear/usageByYear.tpl.html",'<uib-tabset justified="true">\r\n	<uib-tab id="Data" heading="Data">\r\n		<year-table></year-table>\r\n	</uib-tab>\r\n	<uib-tab id="Chart" heading="Chart">\r\n		<year-chart-form></year-chart-form>\r\n		<year-chart></year-chart>\r\n	</uib-tab>\r\n</uib-tabset>')}]),angular.module("BWMonApp.ChartType",[]).directive("chartType",["chartService",function(t){return{restrict:"E",replace:!0,require:"ngModel",template:'<select ng-options="choiceChartType for choiceChartType in ::chartTypeCtrl.chartTypes"></select>',scope:{},bindToController:{chartType:"=ngModel"},controller:function(){var e=t.getChartTypes();angular.extend(this,{chartTypes:e,chartType:e[0]})},controllerAs:"chartTypeCtrl"}}]),angular.module("BWMonApp.Filters",[]).filter("startFrom",function(){return function(t,e){return t.slice(e)}}).filter("toMonth",function(){return function(t){return moment([2012,t]).format("MMMM")}}).filter("timeToDate",function(){return function(t){return new Date(1e3*t)}}).filter("usageInGBytes",function(){return function(t){return Math.round(t/1e3)/1e3}}),angular.module("BWMonApp.SelectMonth",[]).directive("selectMonth",["dataService",function(t){return{restrict:"E",replace:!0,require:["ngModel","year"],template:'<select ng-options="choiceMonth for choiceMonth in selectMonthCtrl.months"></select>',scope:{},bindToController:{month:"=ngModel",year:"=year"},controller:["$scope",function(e){var r=this,a=function(){var e=t.getMonths(r.year);r.months=e,r.month=e[0]};a(),e.$watch("selectMonthCtrl.year",function(){a()},!0)}],controllerAs:"selectMonthCtrl"}}]),angular.module("BWMonApp.SelectYear",[]).directive("selectYear",["dataService",function(t){return{restrict:"E",replace:!0,require:"ngModel",template:'<select ng-options="choiceYear for choiceYear in ::selectYearCtrl.years"></select>',scope:{},bindToController:{year:"=ngModel"},controller:function(){var e=t.getYears();angular.extend(this,{years:e,year:e[0]})},controllerAs:"selectYearCtrl"}}]),angular.module("BWMonApp.Navigation",[]).directive("navigation",["$location",function(t){return{restrict:"E",replace:!0,template:['<div class="navbar navbar-default">','<ul class="nav navbar-nav">','<li ng-repeat="route in ::navigationCtrl.routes" ng-class="{active: navigationCtrl.isActive(\'{{::route.href}}\')}" >','<a href="#{{::route.href}}">{{::route.name}}</a>',"</li>","</ul>","</div>"].join(""),scope:{},controller:["$scope",function(e){angular.extend(this,{isActive:function(e){return e===t.path()},routes:[{href:"/UsageByUser",name:"Usage By User"},{href:"/UsageByMonth",name:"Usage By Month"},{href:"/UsageByYear",name:"Usage By Year"}]})}],controllerAs:"navigationCtrl"}}]),angular.module("BWMonApp.ChartService",[]).factory("chartService",function(){var t=function(t,e){var r="";return t%1===0&&"undefined"!=typeof e[t]&&null!==e[t]&&(r=e[t].id),r},e=function(t){var e="";return t%1===0&&t>=0&&11>=t&&(e=moment({month:t}).format("MMMM")),e},r=function(t,e){var r="";return t%1===0&&"undefined"!=typeof e[t]&&null!==e[t]&&(r=e[t].IP),r},a=function(t,e){var r="";return t%1===0&&"undefined"!=typeof e[t]&&null!==e[t]&&(r=e[t].user),r},n=function(){return["column","line","area"]},s=function(t,e,r){return{series:[{y:"total",color:"#3366CC",label:"GBytes",type:n()[0]}],axes:{x:{labelFunction:function(r){return e(r,t)}}},tooltip:{formatter:function(e,a,n){return r(e,t)+" : "+a}}}};return{getYearLabel:t,getMonthLabel:e,getUserLabel:r,getUserTooltip:a,getChartTypes:n,getChartOptions:s}}),angular.module("BWMonApp.DataService",[]).factory("dataService",function(){var t=bwmonData(),e=function(t,e){var r=e.year-t.year;return 0===r&&(r=e.month-t.month,0===r&&(r=t.IP<e.IP?-1:t.IP>e.IP?1:0,0===r&&(r=e.id-t.id))),r},r=function(t,e,r){var a=0,n=0,s=0;return t.forEach(function(t){a+=t.download,n+=t.upload,s+=t.total}),{id:r,download:a,upload:n,total:s,average:+(s/e).toFixed(3),days:e}},a=function(e){var r=_.where(t,{year:e});return r=_.uniq(r,function(t){return t.month}),r=_.pluck(r,"month")},n=function(){var e=_.uniq(t,function(t){return t.year});return e=_.pluck(e,"year")},s=function(e){var a=moment([e,11,31]).dayOfYear(),n=_.where(t,{year:e});return r(n,a,e)},o=function(e,a,n){var s=_.where(t,{year:e,month:a}),o=moment([e,a]).daysInMonth(),c=r(s,o,a);return n&&(s=_.filter(s,function(t){var e=n.toLowerCase();return-1!==t.IP.toLowerCase().indexOf(e)||-1!==t.MAC.toLowerCase().indexOf(e)||-1!==t.user.toLowerCase().indexOf(e)})),_.each(s,function(t,e){t.percent=+(100*t.total/c.total).toFixed(1)}),{usage:s,total:c}},c=function(t){var e=a(t),r=_.map(e,function(e){return o(t,e).total}),n=s(t);return _.each(r,function(t,e){t.percent=+(100*t.total/n.total).toFixed(1)}),{usage:r,total:n}},i=function(t,e){var r=[],a=t,n=function(t){return Math.round(t/1e3)/1e3};return e&&(a=t.slice().reverse()),r=_.map(a,function(t,e){var r={x:e,id:t.id,total:n(t.total)};return t.IP&&(r.IP=t.IP),t.user&&(r.user=t.user),r})},l=function(){t.sort(e)};return l(),{getYears:n,getMonths:function(t){var e=a(t);return e=_.map(e,function(e){return moment([t,e]).format("MMMM")})},getUsageByUser:function(t,e,r){var a=o(t,moment(t+"-"+e,"YYYY-MMMM").month(),r);return{data:a,chartData:i(a.usage,!1)}},getUsageByMonth:function(t){var e=c(t);return{data:e,chartData:i(e.usage,!0)}},getUsageByYear:function(){var t=n();return t=_.map(t,function(t){return s(t)}),{data:t,chartData:i(t,!0)}}}}),angular.module("BWMonApp.UsageByMonth",["ngRoute"]).config(["$routeProvider",function(t){t.when("/UsageByMonth",{templateUrl:"usagebymonth/usageByMonth.tpl.html",controller:"UsageByMonthController",controllerAs:"usageByMonthCtrl"})}]).directive("monthForm",function(){return{restrict:"E",replace:!0,template:['<form class="form-inline">','<div class="form-group">','<select-year ng-model="usageByMonthCtrl.selected.year" class="form-control" name="year"/>',"</div>","</form>"].join("")}}).directive("monthTable",function(){return{restrict:"E",replace:!0,template:['<div class="table-responsive">','<table class="table table-striped table-hover table-condensed">',"<thead><tr month-header></tr></thead>",'<tbody><tr month-body ng-repeat="current in usageByMonthCtrl.data | orderBy:predicate:usageByMonthCtrl.reverse"></tr></tbody>',"<tfoot><tr month-footer></tr></tfoot>","</table>","</div>"].join("")}}).directive("monthHeader",function(){return{template:['<th><a href="" ng-click="predicate=\'id\'; usageByMonthCtrl.reverse=!usageByMonthCtrl.reverse;">Month</a></th>','<th class="text-right">Down</th>','<th class="text-right">Up</th>','<th class="text-right"><a href="" ng-click="predicate=\'total\'; usageByMonthCtrl.reverse=!usageByMonthCtrl.reverse">Total</a></th>','<th class="text-right">Percent</th>','<th class="text-right">Average</th>','<th class="text-right">Days</th>'].join("")}}).directive("monthBody",function(){return{template:["<td>{{::current.id | toMonth}}</td>",'<td class="text-right">{{::current.download | usageInGBytes | number:3}}</td>','<td class="text-right">{{::current.upload | usageInGBytes | number:3}}</td>','<td class="text-right">{{::current.total | usageInGBytes | number:3}}</td>','<td class="text-right">{{::current.percent | number:1}}%</td>','<td class="text-right">{{::current.average | usageInGBytes | number:3}}</td>','<td class="text-right">{{::current.days}}</td>'].join("")}}).directive("monthFooter",function(){return{template:["<th>{{usageByMonthCtrl.selected.year}} Totals</th>",'<th class="text-right">{{::usageByMonthCtrl.total.download | usageInGBytes | number:3}}</th>','<th class="text-right">{{::usageByMonthCtrl.total.upload | usageInGBytes | number:3}}</th>','<th class="text-right">{{::usageByMonthCtrl.total.total | usageInGBytes | number:3}}</th>',"<th></th>",'<th class="text-right">{{::usageByMonthCtrl.total.average | usageInGBytes | number:3}}</th>','<th class="text-right">{{::usageByMonthCtrl.total.days}}</th>'].join("")}}).directive("monthChartForm",function(){return{restrict:"E",replace:!0,template:['<form class="form-inline">','<div class="form-group">','<select-year ng-model="usageByMonthCtrl.selected.year" class="form-control" name="year"/>',"</div>",'<div class="form-group">','<chart-type ng-model="usageByMonthCtrl.selected.chartType" class="form-control" name="chartType"/>',"</div>","</form>"].join("")}}).directive("monthChart",function(){return{restrict:"E",replace:!0,template:["<div>",'<linechart id="chartData" data="usageByMonthCtrl.chartData" options="usageByMonthCtrl.chartOptions"></linechart>',"</div>"].join("")}}).controller("UsageByMonthController",["$scope","dataService","chartService",function(t,e,r){var a=this;a.selected={},a.predicate="id",a.reverse=!1,t.$watch("usageByMonthCtrl.selected.year",function(){var t=e.getUsageByMonth(a.selected.year);a.data=t.data.usage,a.total=t.data.total,a.chartData=t.chartData,a.chartOptions=r.getChartOptions(a.chartData,r.getMonthLabel,r.getMonthLabel)},!0),t.$watch("usageByMonthCtrl.selected.chartType",function(){a.chartOptions.series[0].type=a.selected.chartType},!0)}]),angular.module("BWMonApp.UsageByUser",["ngRoute"]).config(["$routeProvider",function(t){t.when("/UsageByUser",{templateUrl:"usagebyuser/usageByUser.tpl.html",controller:"UsageByUserController",controllerAs:"usageByUserCtrl"})}]).directive("userForm",function(){return{restrict:"E",replace:!0,template:['<form class="form-inline">','<div class="form-group">','<select-year ng-model="usageByUserCtrl.selected.year" class="form-control" name="year"/>',"</div>",'<div class="form-group">','<select-month ng-model="usageByUserCtrl.selected.month" year="usageByUserCtrl.selected.year" class="form-control" name="month"/>',"</div>",'<div class="form-group">','<input ng-model="usageByUserCtrl.selected.user" class="form-control" name="user" placeholder="IP, MAC or User"/>',"</div>",'<div class="form-group">','<dir-pagination-controls max-size="5" boundary-links="true"></dir-pagination-controls>',"</div>","</form>"].join("")}}).directive("userTable",function(){return{restrict:"E",replace:!0,template:['<div class="table-responsive">','<table class="table table-striped table-hover table-condensed">',"<thead><tr user-header></tr></thead>",'<tbody><tr user-body dir-paginate="current in usageByUserCtrl.data | orderBy:predicate:usageByUserCtrl.reverse | itemsPerPage:usageByUserCtrl.pageSize"></tr></tbody>',"<tfoot><tr user-footer></tr></tfoot>","</table>","</div>"].join("")}}).directive("userHeader",function(){return{template:['<th><a href="" ng-click="predicate=\'IP\'; usageByUserCtrl.reverse=!usageByUserCtrl.reverse">IP</a></th>','<th><a href="" ng-click="predicate=\'MAC\'; usageByUserCtrl.reverse=!usageByUserCtrl.reverse">MAC</a></th>','<th><a href="" ng-click="predicate=\'user\'; usageByUserCtrl.reverse=!usageByUserCtrl.reverse">User</a></th>','<th class="text-right">Down</th>','<th class="text-right">Up</th>','<th class="text-right"><a href="" ng-click="predicate=\'total\'; usageByUserCtrl.reverse=!usageByUserCtrl.reverse">Total</a></th>','<th class="text-right">Percent</th>','<th class="text-right">Average</th>','<th class="text-right">Days</th>',"<th>First Seen</th>","<th>Last Seen</th>"].join("")}}).directive("userBody",function(){return{template:["<td>{{::current.IP}}</td>","<td>{{::current.MAC}}</td>","<td>{{::current.user}}</td>",'<td class="text-right">{{::current.download | usageInGBytes | number:3}}</td>','<td class="text-right">{{::current.upload | usageInGBytes | number:3}}</td>','<td class="text-right">{{::current.total | usageInGBytes | number:3}}</td>','<td class="text-right">{{::current.percent | number:1}}%</td>','<td class="text-right">{{::current.average | usageInGBytes | number:3}}</td>','<td class="text-right">{{::current.days}}</td>',"<td>{{::current.firstSeen | timeToDate | date: 'medium'}}</td>","<td>{{::current.lastSeen | timeToDate | date: 'medium'}}</td>"].join("")}}).directive("userFooter",function(){return{template:['<th colspan="3">{{::usageByUserCtrl.selected.month}} {{::usageByUserCtrl.selected.year}} Totals</th>','<th class="text-right">{{::usageByUserCtrl.total.download | usageInGBytes | number:3}}</th>','<th class="text-right">{{::usageByUserCtrl.total.upload | usageInGBytes | number:3}}</th>','<th class="text-right">{{::usageByUserCtrl.total.total | usageInGBytes | number:3}}</th>',"<th></th>",'<th class="text-right">{{::usageByUserCtrl.total.average | usageInGBytes | number:3}}</th>','<th class="text-right">{{::usageByUserCtrl.total.days}}</th>',"<th></th>","<th></th>"].join("")}}).directive("userChartForm",function(){return{restrict:"E",replace:!0,template:['<form class="form-inline">','<div class="form-group">','<select-year ng-model="usageByUserCtrl.selected.year" class="form-control" name="year"/>',"</div>",'<div class="form-group">','<select-month ng-model="usageByUserCtrl.selected.month" year="usageByUserCtrl.selected.year" class="form-control" name="month"/>',"</div>",'<div class="form-group">','<input ng-model="usageByUserCtrl.selected.user" class="form-control" name="user" placeholder="IP, MAC or User"/>',"</div>",'<div class="form-group">','<chart-type ng-model="usageByUserCtrl.selected.chartType" class="form-control" name="chartType"/>',"</div>","</form>"].join("")}}).directive("userChart",function(){return{restrict:"E",replace:!0,template:["<div>",'<linechart id="chartData" data="usageByUserCtrl.chartData" options="usageByUserCtrl.chartOptions"></linechart>',"</div>"].join("")}}).controller("UsageByUserController",["$scope","dataService","chartService",function(t,e,r){var a=this,n=function(){a.selected.user=""};a.selected={},a.predicate="IP",a.reverse=!1,a.pageSize=12,t.$watch("usageByUserCtrl.selected.year",function(){n(),a.selected.month=e.getMonths(a.selected.year)[0]},!0),t.$watch("usageByUserCtrl.selected.month",function(){n()},!0),t.$watch("usageByUserCtrl.selected",function(){var t=e.getUsageByUser(a.selected.year,a.selected.month,a.selected.user);a.data=t.data.usage,a.total=t.data.total,a.chartData=t.chartData,a.chartOptions=r.getChartOptions(a.chartData,r.getUserLabel,r.getUserTooltip)},!0),t.$watch("usageByUserCtrl.selected.chartType",function(){a.chartOptions.series[0].type=a.selected.chartType},!0)}]),angular.module("BWMonApp.UsageByYear",["ngRoute"]).config(["$routeProvider",function(t){t.when("/UsageByYear",{templateUrl:"usagebyyear/usageByYear.tpl.html",controller:"UsageByYearController",controllerAs:"usageByYearCtrl"})}]).directive("yearTable",function(){return{restrict:"E",replace:!0,template:['<div class="table-responsive">','<table class="table table-striped table-hover table-condensed">',"<thead><tr year-header></tr></thead>",'<tbody><tr year-body ng-repeat="current in usageByYearCtrl.data | orderBy:predicate:usageByYearCtrl.reverse"></tr></tbody>',"</table>","</div>"].join("")}}).directive("yearHeader",function(){return{template:['<th><a href="" ng-click="predicate=\'id\'; usageByYearCtrl.reverse=!usageByYearCtrl.reverse;">Year</a></th>','<th class="text-right">Down</th>','<th class="text-right">Up</th>','<th class="text-right"><a href="" ng-click="predicate=\'total\'; usageByYearCtrl.reverse=!usageByYearCtrl.reverse">Total</a></th>','<th class="text-right">Average</th>','<th class="text-right">Days</th>'].join("")}}).directive("yearBody",function(){return{template:["<td>{{current.id}}</td>",'<td class="text-right">{{::current.download | usageInGBytes | number:3}}</td>','<td class="text-right">{{::current.upload | usageInGBytes | number:3}}</td>','<td class="text-right">{{::current.total | usageInGBytes | number:3}}</td>','<td class="text-right">{{::current.average | usageInGBytes | number:3}}</td>','<td class="text-right">{{::current.days}}</td>'].join("")}}).directive("yearChartForm",function(){return{restrict:"E",replace:!0,template:['<form class="form-inline">','<div class="form-group">','<chart-type ng-model="usageByYearCtrl.selected.chartType" class="form-control" name="chartType"/>',"</div>","</form>"].join("")}}).directive("yearChart",function(){return{restrict:"E",replace:!0,template:["<div>",'<linechart id="chartData" data="usageByYearCtrl.chartData" options="usageByYearCtrl.chartOptions"></linechart>',"</div>"].join("")}}).controller("UsageByYearController",["$scope","dataService","chartService",function(t,e,r){var a=this,n=e.getUsageByYear();a.selected={},a.predicate="id",a.reverse=!1,a.data=n.data,a.chartData=n.chartData,a.chartOptions=r.getChartOptions(a.chartData,r.getYearLabel,r.getYearLabel),t.$watch("usageByYearCtrl.selected.chartType",function(){a.chartOptions.series[0].type=a.selected.chartType},!0)}])}();
//# sourceMappingURL=bwmon.min.js.map
